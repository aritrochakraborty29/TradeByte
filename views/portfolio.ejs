<main class="md:col-span-4 md:ml-56 lg:ml-64 md:pr-14 w-full">
  <div class="container px-5 py-10 mx-auto md:px-auto">
    <!-- <div class="absolute-center mx-auto"> -->

    <!-- header -->

    <header class="my-4 absolute-center">
      <span
        class="text-gray-700 text-3xl font-semibold leading-none tracking-wider"
        >Hello,</span
      >
      <h2 class="text-gray-800 text-5xl leading-none tracking-wider view-link">
        <%= user.displayName%>.
      </h2>
    </header>

    <hr class="line" />

    <!-- search box -->

    <div>
      <div class="bg-white relative text-gray-800 mt-12 shadow-md rounded-lg">
        <input
          id="searchbar"
          type="search"
          name="serch"
          placeholder="Search Stocks"
          class="bg-transparent h-10 px-5 pl-10 rounded-full text-lg focus:outline-none"
        />
        <button type="submit" class="absolute left-0 top-0 mt-3 ml-4">
          <svg
            class="h-4 w-4 fill-current"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            version="1.1"
            id="Capa_1"
            x="0px"
            y="0px"
            viewBox="0 0 56.966 56.966"
            style="enable-background: new 0 0 56.966 56.966"
            xml:space="preserve"
            width="512px"
            height="512px"
          >
            <path
              d="M55.146,51.887L41.588,37.786c3.486-4.144,5.396-9.358,5.396-14.786c0-12.682-10.318-23-23-23s-23,10.318-23,23  s10.318,23,23,23c4.761,0,9.298-1.436,13.177-4.162l13.661,14.208c0.571,0.593,1.339,0.92,2.162,0.92  c0.779,0,1.518-0.297,2.079-0.837C56.255,54.982,56.293,53.08,55.146,51.887z M23.984,6c9.374,0,17,7.626,17,17s-7.626,17-17,17  s-17-7.626-17-17S14.61,6,23.984,6z"
            />
          </svg>
        </button>
      </div>

      <ul
        id="search-result"
        style="height: 0px; overflow: hidden; white-space: pre"
        class="text-lg p-5 ml-10 list-none mt-0 text-gray-700"
      ></ul>

      <div class="mt-4 grid lg:grid-cols-3 gap-10">
        <!-- cards go here -->

        <!-- card1 -->

        <div
          class="card rounded-xl flex items-center h-20 sm:h-20 w-full object-cover px-5 shadow-2xl"
        >
          <div class="flex-shrink-0 w-10 h-10">
            <img class="w-full h-full" src="images/graph.jpeg" alt=" " />
          </div>
          <div class="font-bold text-xl xl:text-2xl ml-3">
            <p class="text-gray-900 whitespace-no-wrap">$40,342.04</p>
            <span class="block text-gray-500 text-sm">Total Portfolio</span>
          </div>
        </div>

        <!-- card 2 -->

        <div
          class="card rounded-xl flex items-center h-20 sm:h-20 w-full object-cover px-5 shadow-2xl"
        >
          <div class="flex-shrink-0 w-10 h-10">
            <img class="w-full h-full" src="images/graph.jpeg " alt=" " />
          </div>
          <div class="font-bold text-xl xl:text-2xl ml-3 justify-center">
            <p class="text-gray-900 whitespace-no-wrap">$ 40,342.04</p>
            <span class="block text-gray-500 text-sm">Profit / Loss</span>
          </div>
        </div>

        <!-- card 3 -->

        <div
          class="card rounded-xl flex items-center h-20 sm:h-20 w-full object-cover px-5 shadow-2xl"
        >
          <div class="flex-shrink-0 w-10 h-10">
            <img class="w-full h-full" src="images/graph.jpeg " alt=" " />
          </div>
          <div class="font-bold text-xl xl:text-2xl ml-3">
            <p class="text-gray-900 whitespace-no-wrap">$40,342.04</p>
            <span class="block text-gray-500 text-sm">$ Balance</span>
          </div>
        </div>
      </div>
    </div>

    <!-- overview heading -->

    <h2 class="text-lg font-bold leading-tight py-3 mt-8">Overview</h2>
    <!-- graph card -->
    <div class="bg-white rounded-lg card h-64 w-auto mb-10 shadow-2xl"></div>

    <!-- container for both tables -->

    <div class="lg:grid lg:grid-cols-2 -mx-8">
      <!-- table component 1 -->

      <div class="px-3 sm:px-6 py-4 overflow-hidden h-auto w-full">
        <div class="flex justify-between">
          <!-- heading of table -->
          <h2 class="text-lg font-bold leading-tight py-3">Trade History</h2>
          <a href="#" class="mt-3 font-bold text-tempc-400"
            >View All <span class="font-extrabold">></span></a
          >
        </div>

        <!-- start of table -->

        <div
          class="px-5 inline-block min-w-0 shadow-lg rounded-lg overflow-hidden"
        >
          <table class="min-w-0 leading-normal">
            <thead>
              <tr>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  date
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  platform
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  fair
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  action
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  amount
                </th>
              </tr>
            </thead>

            <!-- table body -->

            <tbody>
              <tr class="bg-white">
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-600 whitespace-no-wrap">Jan 21, 2020</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">Gdax</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    btc/usd
                  </p>
                </td>
                <td class="px-5 py-3 border-b border-gray-200 text-sm">
                  <span
                    class="relative inline-block px-3 py-1 font-semibold text-white leading-tight"
                  >
                    <span
                      aria-hidden
                      class="absolute inset-0 bg-tempc-500 rounded-full"
                    ></span>
                    <span class="relative">Sell</span>
                  </span>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    <span class="text-tempc-500">+</span>0.230046
                  </p>
                </td>
              </tr>
              <tr class="bg-gray-100">
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-600 whitespace-no-wrap">Jan 8, 2020</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">Bitterx</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    btc/usd
                  </p>
                </td>

                <td class="px-5 py-3 border-b border-gray-200 text-sm">
                  <span
                    class="relative inline-block px-3 py-1 font-semibold text-white leading-tight"
                  >
                    <span
                      aria-hidden
                      class="absolute inset-0 bg-tempc-400 rounded-full"
                    ></span>
                    <span class="relative">Buy</span>
                  </span>
                </td>

                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    <span class="text-tempc-400">-</span>0.230046
                  </p>
                </td>
              </tr>
              <tr class="bg-white">
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-600 whitespace-no-wrap">Jan 21, 2020</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">Gdax</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    btc/usd
                  </p>
                </td>

                <td class="px-5 py-3 border-b border-gray-200 text-sm">
                  <span
                    class="relative inline-block px-3 py-1 font-semibold text-white leading-tight"
                  >
                    <span
                      aria-hidden
                      class="absolute inset-0 bg-tempc-500 rounded-full"
                    ></span>
                    <span class="relative">Sell</span>
                  </span>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    <span class="text-tempc-500">+</span>0.230046
                  </p>
                </td>
              </tr>
              <tr class="bg-gray-100">
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-600 whitespace-no-wrap">Jan 8, 2020</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">Bitterx</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    btc/usd
                  </p>
                </td>

                <td class="px-5 py-3 border-b border-gray-200 text-sm">
                  <span
                    class="relative inline-block px-3 py-1 font-semibold text-white leading-tight"
                  >
                    <span
                      aria-hidden
                      class="absolute inset-0 bg-tempc-400 rounded-full"
                    ></span>
                    <span class="relative">Buy</span>
                  </span>
                </td>

                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    <span class="text-tempc-400">-</span>0.230046
                  </p>
                </td>
              </tr>
              <tr class="bg-white">
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-600 whitespace-no-wrap">Jan 21, 2020</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">Gdax</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    btc/usd
                  </p>
                </td>

                <td class="px-5 py-3 border-b border-gray-200 text-sm">
                  <span
                    class="relative inline-block px-3 py-1 font-semibold text-white leading-tight"
                  >
                    <span
                      aria-hidden
                      class="absolute inset-0 bg-tempc-500 rounded-full"
                    ></span>
                    <span class="relative">Sell</span>
                  </span>
                </td>

                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    <span class="text-tempc-500">+</span>0.230046
                  </p>
                </td>
              </tr>
              <tr class="bg-gray-100">
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-600 whitespace-no-wrap">Jan 8, 2020</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">Bitterx</p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    btc/usd
                  </p>
                </td>

                <td class="px-5 py-3 border-b border-gray-200 text-sm">
                  <span
                    class="relative inline-block px-3 py-1 font-semibold text-white leading-tight"
                  >
                    <span
                      aria-hidden
                      class="absolute inset-0 bg-tempc-400 rounded-full"
                    ></span>
                    <span class="relative">Buy</span>
                  </span>
                </td>

                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap uppercase">
                    <span class="text-tempc-400">-</span>0.230046
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- table component 2 -->

      <div class="px-3 sm:px-8 py-4 overflow-auto h-auto w-full">
        <!-- table name stocks status -->

        <div class="flex justify-between">
          <h2 class="text-lg font-bold leading-tight py-3">Stock Status</h2>
          <a href="#" class="mt-3 pr-42 font-bold text-tempc-400"
            >View All <span class="font-extrabold">></span></a
          >
        </div>

        <!-- table start -->

        <div class="inline-block min-w-0 shadow-lg rounded-lg overflow-hidden">
          <table class="min-w-0 leading-normal">
            <!-- table head -->

            <thead>
              <tr>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  name
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  amount
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  current
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  status
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  Number Of Stock
                </th>
                <th
                  class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  sell
                </th>
              </tr>
            </thead>

            <!-- table body -->

            <tbody>
              <% user.stock.forEach( (stock) => { %>
              <tr class="bg-white">
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">
                    <%= stock.companySymbol %>
                  </p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">
                    <% currentPrice = 500 %> $<%= currentPrice %>
                  </p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="block px-4 flex">
                    <% let price = stock.stockPrice - currentPrice %> <%
                    if(price < 0) { %> <% color="red" %>
                    <span
                      >$<%= price.toPrecision(4) %><span
                        class="text-red-600 text-lg"
                        >&#8595;</span
                      ></span
                    >
                    <% } else { %> <% color="green" %>
                    <span
                      >$<%= price.toPrecision(4) %><span
                        class="text-green-600 text-lg"
                        >&#8593;</span
                      ></span
                    >
                    <% } %>
                  </p>
                </td>
                <td
                  class="px-3 py-3 border-b border-gray-200 text-<%= color%>-600 text-sm"
                >
                  <p class="text-tempc-400 whitespace-no-wrap">
                    <% if(stock.stockPrice > currentPrice) { %> <% loss =
                    stock.stockPrice - currentPrice %> <% status =
                    (loss/stock.stockPrice) * 100 %> <% } else
                    if(stock.stockPrice < currentPrice) { %> <% gain =
                    currentPrice - stock.stockPrice %> <% status =
                    (gain/stock.stockPrice) * 100 %> <% } %>
                    <span><%= status.toPrecision(4) %>%</span>
                  </p>
                </td>
                <td class="px-3 py-3 border-b border-gray-200 text-sm">
                  <p class="text-gray-900 whitespace-no-wrap">
                    <%= stock.noOfStock %>
                  </p>
                </td>
                <td
                  class="px-3 py-3 border-b border-gray-200 text-sm text-tempc-400"
                >
                  <form
                    action="/transaction/sell/<%= stock._id%>"
                    method="POST"
                    id="sell-stock"
                  >
                    <button type="submit">
                      <svg
                        class="w-6 h-6"
                        fill="none"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        viewBox="0 0 24 24"
                        stroke="green"
                      >
                        <path
                          d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                        ></path>
                      </svg>
                    </button>
                  </form>
                </td>
              </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- end of tables -->

    <!-- lode more -->
    <div class="mt-12 flex justify-center">
      <div
        class="btn bg-secondary-100 text-secondary-200 inline-block hover:shadow-inner transform hover:scale-125 hover:bg-opacity-50 transition ease-out duration-300"
      >
        Load more
      </div>
    </div>
  </div>

  <!-- </div> -->
</main>

<!-- script for search bar -->

<script>
    const inputField = document.getElementById('searchbar')
    inputField.addEventListener('input', (event) => {
        console.log(event.target.value)
        const value = event.target.value
            //sample data
        const dataset = <%- JSON.stringify(totalData) %>;

  // when symbol matches

        let data = dataset.filter(function(el) {
            return el.Symbol.includes(value.toUpperCase())
        })

  // when no symbol matches

        if (data.length === 0) {

  let data1 = dataset.filter(function(el) {
      return (el["Company Name"].toLowerCase().includes(value.toLowerCase()))
  })
  data = data1;
  }

        let list = "";
        if (value === "") {
            list = "";
            data = [];
        }
        let n = data.length
        for (i = 0; i <= (n - 1); i++) {
            let item = data[i];
            list += `<li><a href='/view/${item.Symbol}'>${item.Symbol}</a></li>` } document.getElementById('search-result').innerHTML = list ;console.log(data) })
</script>
